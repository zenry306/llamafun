window.fbAsyncInit=function(){FB.init({appId:'1895947000621168',cookie:!0,xfbml:!0,version:'v2.9'});FB.AppEvents.logPageView()};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return}
js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/zh_TW/sdk.js";fjs.parentNode.insertBefore(js,fjs)}(document,'script','facebook-jssdk'));var reCAPTCHA_LOGIN_STATUS=!1;var reCAPTCHA_LOGIN_CALLBACK=null;var verifyCallback_login=function(response){reCAPTCHA_LOGIN_STATUS=!0;reCAPTCHA_LOGIN_CALLBACK=response};var expiredCallback_login=function(){reCAPTCHA_LOGIN_STATUS=!1};var reCAPTCHA_REG_STATUS=!1;var reCAPTCHA_REG_CALLBACK=null;var verifyCallback_reg=function(response){reCAPTCHA_REG_STATUS=!0;reCAPTCHA_REG_CALLBACK=response};var expiredCallback_reg=function(){reCAPTCHA_REG_STATUS=!1};var reCAPTCHA_LOGIN;var reCAPTCHA_REG;var onloadCallback=function(){reCAPTCHA_LOGIN=grecaptcha.render(document.getElementById('reCAPTCHA_LOGIN'),{'sitekey':'6LekoDEUAAAAAGu6IU0YaFRPSlNkuC2JtkDZrXeJ','callback':verifyCallback_login,'expired-callback':expiredCallback_login,'theme':'light'});reCAPTCHA_REG=grecaptcha.render(document.getElementById('reCAPTCHA_REG'),{'sitekey':'6LekoDEUAAAAAGu6IU0YaFRPSlNkuC2JtkDZrXeJ','callback':verifyCallback_reg,'expired-callback':expiredCallback_reg,'theme':'light'})};function login_pressenter(e){if(e.keyCode==13){$('.popup_loginbtn').click()}}
function register_pressenter(e){if(e.keyCode==13){$('.popup_registerbtn').click()}}
function check_iamgesrc_exist(image_src){var img=new Image();img.src=image_src;if(img.width==0){return!1}
else{return!0}}
$(function(){$(window).on('click',function(event){if(event.target==report_popup){$('body').css('overflow','auto');$('.report_popup').hide();$('.popup_report-next-unchecked').removeClass("popup_report-next");$('.report-radio-other').val('');$(".report-radio").find("input:radio").prop("checked",!1).end().buttonset("refresh")}
else if(event.target==contact_popup){$('body').css('overflow','auto');$('.contact_popup').css('display','none')}
else if(event.target==register_popup){$('body').css('overflow','auto');$('.register_popup').css('display','none')}
else if(event.target==login_popup){$('body').css('overflow','auto');$('.login_popup').css('display','none')}
else if(event.target==forgotpw_popup){$('body').css('overflow','auto');$('.forgotpw_popup').css('display','none')}
else if(event.target==comment_img_popup){$('body').css('overflow','auto');$('.comment_img_popup').css('display','none')}
else if(event.target==leaderboard_popup){$('body').css('overflow','auto');$('.leaderboard_popup').css('display','none')}
else if(event.target==side_nav_popup){$('body').css('overflow','auto');$('#side-nav').width('0');$('.side_nav_popup').css('display','none')}});var w=0;w=$(window).width();$(window).resize(function(){if(w!=$(window).width()){$('body').css('overflow','auto');$('.leaderboard_popup').hide();$('#side-nav').width('0');$('.side_nav_popup').css('display','none');w=$(window).width();delete w}});$(document).on('click','.nav-close',function(){$('body').css('overflow','auto');$('.side_nav_popup').css('display','none');$('#side-nav').width('0')});$(document).on('click','.toggle-nav',function(){$('body').css('overflow','hidden');$('.side_nav_popup').css('display','block');$('#side-nav').width('250')});var tolerancePixel=40;function checkMedia(){var media=$('video').not("[autoplay='autoplay']");var scrollTop=$(window).scrollTop()+tolerancePixel;var scrollBottom=$(window).scrollTop()+$(window).height()-tolerancePixel;media.each(function(index,el){var yTopMedia=$(this).offset().top;var yBottomMedia=$(this).height()+yTopMedia;if(scrollTop<yBottomMedia&&scrollBottom>yTopMedia){$(this).get(0).play();$(this).next(".playpause").hide()}else{$(this).get(0).pause();$(this).next(".playpause").show()}})}
$(document).on('scroll',checkMedia);var THREADLOAD_FINISH=!0;$(window).scroll(function(){if($(window).scrollTop()+$(window).height()>=Math.round($(document).height()*0.9)){if($('.thread-loding').length){var THREAD_LODING_ID=$(".thread-loding").attr('id').split('_');var THREAD_TYPE=THREAD_LODING_ID[0];var DATE=THREAD_LODING_ID[1];var HOTNESS=THREAD_LODING_ID[2];var POST_MEMBER_ID=THREAD_LODING_ID[3];$('.thread-loding').show();if(THREADLOAD_FINISH===!0){THREADLOAD_FINISH=!1;$.ajax({type:'POST',url:'/thread-show-more.php',data:{thread_type:THREAD_TYPE,date:DATE,hotness:HOTNESS,post_member_id:POST_MEMBER_ID},success:function(html){$('.thread-loding').hide();$('.thread-loding').replaceWith(html);THREADLOAD_FINISH=!0}})}}}});$(document).on('click','.leaderboard_btn',function(){$('.leaderboard_popup').css('display','block');$('body').css('overflow','hidden')});$(document).on('click','.leaderboard_popup-close',function(){$('body').css('overflow','auto');$('.leaderboard_popup').hide()});$(document).on('click','.contact-us',function(){$('.contact_finished').css('display','none');$('.contact-card').css('display','block');$('.contact_popup').css('display','block');$('body').css('overflow','hidden')});$(document).on('click','.contact_popup-close',function(){$('body').css('overflow','auto');$('.contact_popup').hide()});$(document).on('click','.contact-submit',function(){var sub_con_format=/(?!^\s+$)^(.|\n)+$/;var username_format=/^[\u4e00-\u9fa5\w-]+$/;var mail_format=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;var USERNAME=document.getElementById("contact_username").value;var EMAIL=document.getElementById("contact_email").value;var CATEGORY=$('.contact_category').find(":selected").text();var SUBJECT=document.getElementById("contact_subject").value;var CONTENT=document.getElementById("contact_content").value;var check=!0;$('.contact_errormsg').css('visibility','hidden');if(USERNAME.length<1){$('#con_error_username').css('visibility','visible');document.getElementById("con_error_username").innerHTML="暱稱不能為空喔！";check=!1}
else{if(!USERNAME.match(username_format)){$('#con_error_username').css('visibility','visible');document.getElementById("con_error_username").innerHTML="不能使用注音　符號只能使用-或_";check=!1}}
if(EMAIL.length<1){$('#con_error_email').css('visibility','visible');document.getElementById("con_error_email").innerHTML="信箱不能為空！";check=!1}
else{if(!EMAIL.match(mail_format)){$('#con_error_email').css('visibility','visible');document.getElementById("con_error_email").innerHTML="信箱格式不正確";check=!1}}
if(CATEGORY=="請選擇類別..."){$('#con_error_category').css('visibility','visible');document.getElementById("con_error_category").innerHTML="請選擇一項類別";check=!1}
if(SUBJECT.length<1){$('#con_error_subject').css('visibility','visible');document.getElementById("con_error_subject").innerHTML="還沒有填標題喔！";check=!1}
else{if(!SUBJECT.match(sub_con_format)){$('#con_error_subject').css('visibility','visible');document.getElementById("con_error_subject").innerHTML="還沒有填標題喔！";check=!1}}
if(CONTENT.length<1){$('#con_error_content').css('visibility','visible');document.getElementById("con_error_content").innerHTML="還沒有填內容喔！";check=!1}
else{if(!CONTENT.match(sub_con_format)){$('#con_error_content').css('visibility','visible');document.getElementById("con_error_content").innerHTML="還沒有填內容喔！";check=!1}}
if(check===!0){$(".contact-card *").prop('disabled',!0);$('.contact-submit').text('傳送中..');$.ajax({type:'POST',url:'/contact-us.php',data:{username:USERNAME,email:EMAIL,category:CATEGORY,subject:SUBJECT,content:CONTENT},success:function(response){var response=response.trim();if(response==="success"){$('.contact-card').css('display','none');$('.contact_finished').css('display','block');$(".contact-card *").prop('disabled',!1);$('.contact-submit').text('送出');$(".contact-card input").val('');$(".contact_content").val('');$('.contact_category').val('choose')}
else{$('#con_error_submit').css('visibility','visible');document.getElementById("con_error_submit").innerHTML="送出失敗，請再試一次";$(".contact-card *").prop('disabled',!1)}}})}});var canvas=null;var context=null;var img_newwidth=null;var img_newheight=null;var image=new Image();var top_fontsize=36;var bottom_fontsize=36;var thread_imgtype=null;var thread_uploadtype=null;var thread_imgfile=null;var thread_imgurl=null;var thread_imgurl_temp=null;function new_post(img,img_type,upload_type){thread_imgtype=img_type;thread_uploadtype=upload_type;if(upload_type==='file'){var reader=new FileReader();reader.onload=function(){thread_imgfile=img;image.src=reader.result;if(img_type==='image/gif'){$(".preview-gif").attr("src",reader.result)}}
reader.readAsDataURL(img)}
else if(upload_type==='url'){thread_imgurl=img;image.src='/'+img;if(img_type==='image/gif'){$(".preview-gif").attr("src",img)}}
image.onload=function(){top_fontsize=36;bottom_fontsize=36;$(".meme-inputtext").val('');$("textarea.thread-subject").val('');$(".thread_uploadimg").val('');$(".thread_uploadimg_url").val('');$('body').css('overflow','hidden');if(img_type==='image/gif'){$(".meme-inputtext").prop('disabled',!0);$('.meme-inputtext').attr('placeholder','輸入文字限制使用JPG、PNG');$(".meme_fontsize").prop('disabled',!0);$(".meme_fontsize").addClass('meme_fontsize-disabled');$('.meme-canvas').hide();$('.preview-gif').show();$('.newthread_popup').css('display','block');$('.newthread-upload').hide();$('.newthread-post').show()}
else{$(".meme-inputtext").prop('disabled',!1);$('#topline').attr('placeholder','上排文字');$('#bottomline').attr('placeholder','下排文字');$(".meme_fontsize").prop('disabled',!1);$(".meme_fontsize").removeClass('meme_fontsize-disabled');$('.preview-gif').hide();$('.meme-canvas').show();var img_width=image.width;var img_height=image.height;img_newwidth=540;img_newheight=Math.round(img_height*img_newwidth/img_width);canvas=document.getElementById("meme-canvas");context=canvas.getContext("2d");canvas.width=img_newwidth;canvas.height=img_newheight;context.drawImage(image,0,0,img_newwidth,img_newheight);context.textAlign="center";context.font="bold "+top_fontsize+"pt Noto Sans TC, sans-serif";context.fillStyle="white";context.strokeStyle="black";context.lineWidth=2;$('.newthread_popup').css('display','block');$('.newthread-upload').hide();$('.newthread-post').show()}}
image.onerror=function(){if(img_type==='image/gif'){top_fontsize=36;bottom_fontsize=36;$(".meme-inputtext").val('');$("textarea.thread-subject").val('');$(".thread_uploadimg").val('');$(".thread_uploadimg_url").val('');$('body').css('overflow','hidden');$(".meme-inputtext").prop('disabled',!0);$('.meme-inputtext').attr('placeholder','輸入文字限制使用JPG、PNG');$(".meme_fontsize").prop('disabled',!0);$(".meme_fontsize").addClass('meme_fontsize-disabled');$('.meme-canvas').hide();$('.preview-gif').show();$('.newthread_popup').css('display','block');$('.newthread-upload').hide();$('.newthread-post').show()}
else{$('.uploadimg_url-error').css('visibility','visible');$('.uploadimg_url-error').text('出現錯誤，請再試一次')}}}
function check_imgfile(img_file){if(typeof(img_file)!="undefined"&&img_file!=null){var img_type=img_file.type;if(img_type==="image/png"||img_type==="image/jpeg"||img_type==="image/jpg"||img_type==="image/gif"){var img_size=img_file.size/1024/1024;if(img_size<=10){new_post(img_file,img_type,'file')}
else{alert("Daddy Too Big!!!!  最大10MB喔!!!");$(".thread_uploadimg").val('')}}
else{alert("只能上傳圖片檔喔！JPG、PNG、GIF");$(".thread_uploadimg").val('')}}}
if($('.loggedin_username').length){var obj=$(window);obj.bind('dragover',function(e)
{e.stopPropagation();e.preventDefault();$('.is-dragover').css('display','block')});$('.is-dragover').bind('dragleave',function(e)
{e.stopPropagation();e.preventDefault();$('.is-dragover').css('display','none')});obj.on('drop',function(e)
{$('.is-dragover').css('display','none');e.stopPropagation();e.preventDefault();var files=e.originalEvent.dataTransfer.files;var LOGGEDIN_CHECK=$('.newthreadbtn').attr('id');if(LOGGEDIN_CHECK!=!0){$('body').css('overflow','hidden');$('.login_popup').css('display','block')}
else{check_imgfile(files[0])}})}
$(document).on('change','.thread_uploadimg',function(){var img_file=$(this)[0].files[0];check_imgfile(img_file)});var globalTimeout_thread=null;$(document).on('paste keyup','.thread_uploadimg_url',function(){if(globalTimeout_thread!=null){clearTimeout(globalTimeout_thread)}
globalTimeout_thread=setTimeout(function(){globalTimeout_thread=null;var img_url=$('.thread_uploadimg_url').val();$('.uploadimg_url-error').css('visibility','visible');$('.uploadimg_url-error').text('載入中...');$.ajax({type:'POST',url:'/uploadimg-url-check.php',data:{image_url:img_url},success:function(response){var response=response.trim();if(response==="image/gif"){var img_type=response;$('.uploadimg_url-error').css('visibility','hidden');$('.uploadimg_url-error').text('URL');new_post(img_url,img_type,'url')}
else if(response==="image/png"||response==="image/jpeg"||response==="image/jpg"){var img_type=response;urlimg_savetotemp(img_url,img_type,'url')}
else if(response==='網址錯誤'){$('.uploadimg_url-error').css('visibility','visible');$('.uploadimg_url-error').text('網址錯誤喔！')}
else if(response==='圖片太大'){$('.uploadimg_url-error').css('visibility','visible');$('.uploadimg_url-error').text('上限為10MB喔！')}
else if(response==='不支援網址'){$('.uploadimg_url-error').css('visibility','visible');$('.uploadimg_url-error').text('只能使用圖片網址喔！')}}})},500)});function urlimg_savetotemp(img_url,img_type,upload_type){$.ajax({type:'POST',url:'/imgurl-temp.php',data:{image_url:img_url},success:function(response){if(response===!1){$('.uploadimg_url-error').css('visibility','visible');$('.uploadimg_url-error').text('出現錯誤，請再試一次')}
else{var img_url_temp=response.trim();new_post(img_url_temp,img_type,upload_type);thread_imgurl_temp=img_url_temp;$('.uploadimg_url-error').css('visibility','hidden');$('.uploadimg_url-error').text('URL')}}})}
function urlimg_savetotemp_delete(img_url){$.ajax({type:'POST',url:'/imgurl-temp-delete.php',data:{thread_imgurl_temp:img_url},success:function(response){}})}
$(document).on('click','.newthreadbtn',function(){var LOGGEDIN_CHECK=$('.newthreadbtn').attr('id');if(LOGGEDIN_CHECK!=!0){$('body').css('overflow','hidden');$('.login_popup').css('display','block')}
else{$('body').css('overflow','hidden');$('.newthread_popup').css('display','block')}});$(document).on('click','.newthread_popup-close',function(){$('body').css('overflow','auto');$('.newthread_popup').hide()});$(document).on('click','.newthread_post-close',function(){if(thread_imgtype==="image/png"||thread_imgtype==="image/jpeg"||thread_imgtype==="image/jpg"){urlimg_savetotemp_delete(thread_imgurl_temp)}
$('body').css('overflow','auto');$('.thread_subject_msg').css('visibility','hidden');$('.newthread_popup').hide();$('.newthread-post').hide();$('.newthread-upload').show()});$(document).on('click','.post-backtoup',function(){if(thread_imgtype==="image/png"||thread_imgtype==="image/jpeg"||thread_imgtype==="image/jpg"){urlimg_savetotemp_delete(thread_imgurl_temp)}
$('.thread_subject_msg').css('visibility','hidden');$('.newthread-post').hide();$('.newthread-upload').show()});$(document).on('click','.newthread-send',function(){var SUBJECT=$("textarea.thread-subject").val();var format=/(?!^\s+$)^(.|\n)+$/;var format_correct=!0;$('.thread_subject_msg').css('visibility','visible');if(SUBJECT.length<1){document.getElementById("thread_subject_msg").innerHTML="還沒有填標題喔！";format_correct=!1}
else{if(!SUBJECT.match(format)){document.getElementById("thread_subject_msg").innerHTML="還沒有填標題喔！";format_correct=!1}}
if(format_correct==!0){$('.thread_subject_msg').css('visibility','hidden');document.getElementById("thread_subject_msg").innerHTML="標題";var formdata=new FormData();formdata.append('thread_subject',SUBJECT);formdata.append('thread_uploadtype',thread_uploadtype);formdata.append('img_type',thread_imgtype);var topline_text=$('textarea#topline').val();var bottomline_text=$('textarea#bottomline').val();if(topline_text.length>0||bottomline_text.length>0){var dataURL=canvas.toDataURL('image/jpeg',0.4);formdata.append('thread_uploadtype','canvas');formdata.append('upload_img',dataURL);formdata.append('thread_imgurl_temp',thread_imgurl_temp)}
else{if(thread_uploadtype==="file"){formdata.append('upload_img',thread_imgfile)}
else if(thread_uploadtype==="url"){formdata.append('upload_img',thread_imgurl);formdata.append('thread_imgurl_temp',thread_imgurl_temp)}}
$('.newthread-send').text('傳送中...');$(".newthread-post *").prop('disabled',!0);$.ajax({type:'POST',url:'/newthread-db.php',data:formdata,processData:!1,contentType:!1,success:function(response){var response=response.trim();var threadid_format=/^[\w]{8}$/;if(response.match(threadid_format)){window.location="/thread-show.php?thread_id="+response}
else{alert("發文失敗喔！ 請再嘗試一次");$('.newthread-send').text('發文');$(".newthread-post *").prop('disabled',!1)}}})}});$(document).on('click','.thread_image',function(){if($(this).children(".gif-video").get(0).paused){$(this).children(".gif-video").get(0).play();$(this).children(".playpause").hide()}else{$(this).children(".gif-video").get(0).currentTime=0;$(this).children(".gif-video").get(0).play()}});$(document).on('keyup','.meme-inputtext',function(){var INPUTLINE=$(this).attr('id');var x=img_newwidth/2;var text_maxwidth=img_newwidth-20;var topline_text=$('textarea#topline').val();var bottomline_text=$('textarea#bottomline').val();var array_top=topline_text.split("\n");var array_bottom=bottomline_text.split("\n");context.clearRect(0,0,img_newwidth,img_newheight);context.drawImage(image,0,0,img_newwidth,img_newheight);var topline_y=top_fontsize+14;for(var i=0;i<array_top.length;i++){context.font="bold "+top_fontsize+"pt Noto Sans TC, sans-serif";context.fillText(array_top[i],x,topline_y,text_maxwidth);context.strokeText(array_top[i],x,topline_y,text_maxwidth);topline_y+=top_fontsize+14}
var bottomline_y=img_newheight-20;for(var i=0;i<array_bottom.length;i++){context.font="bold "+bottom_fontsize+"pt Noto Sans TC, sans-serif";context.fillText(array_bottom[i],x,bottomline_y,text_maxwidth);context.strokeText(array_bottom[i],x,bottomline_y,text_maxwidth);bottomline_y-=bottom_fontsize+14}});$(document).on('click','.meme_fontsize',function(){var meme_fontsize=$(this).attr('id');var x=img_newwidth/2;var text_maxwidth=img_newwidth-20;var topline_text=$('textarea#topline').val();var bottomline_text=$('#bottomline').val();var array_top=topline_text.split("\n");var array_bottom=bottomline_text.split("\n");context.clearRect(0,0,img_newwidth,img_newheight);context.drawImage(image,0,0,img_newwidth,img_newheight);if(meme_fontsize==='topline_increase'){top_fontsize+=2}
else if(meme_fontsize==='topline_decrease'){if(top_fontsize>=18){top_fontsize-=2}}
else if(meme_fontsize==='bottomline_increase'){bottom_fontsize+=2}
else if(meme_fontsize==='bottomline_decrease'){if(bottom_fontsize>=18){bottom_fontsize-=2}}
var topline_y=top_fontsize+14;for(var i=0;i<array_top.length;i++){context.font="bold "+top_fontsize+"pt Noto Sans TC, sans-serif";context.fillText(array_top[i],x,topline_y,text_maxwidth);context.strokeText(array_top[i],x,topline_y,text_maxwidth);topline_y+=top_fontsize+14}
var bottomline_y=img_newheight-20;for(var i=0;i<array_bottom.length;i++){context.font="bold "+bottom_fontsize+"pt Noto Sans TC, sans-serif";context.fillText(array_bottom[i],x,bottomline_y,text_maxwidth);context.strokeText(array_bottom[i],x,bottomline_y,text_maxwidth);bottomline_y-=bottom_fontsize+14}});var get_url_hash=window.location.hash.substr(1).split('&');var get_accessToken=get_url_hash[0].split('=');if(get_accessToken[0]==='access_token'){var FB_ACCESS_TOKEN=get_accessToken[1];$.ajax({type:'POST',url:'/register-fb-manually.php',data:{fb_access_token:FB_ACCESS_TOKEN},success:function(response){var response=response.trim();if(response==='success'){facebook_reg_manually();/*FACEBOOK註冊-手動*/}
else{alert('facebook登入失敗，請再試一次')}}})}
function facebook_reg_manually(){FB.getLoginStatus(function(response){if(response.status==='connected'){var uid=response.authResponse.userID;var accessToken=response.authResponse.accessToken;FB.api('/me',{fields:'name'},function(response){var FB_NAME=response.name.trim();var FB_ID=response.id;$.ajax({type:'POST',url:'/register-fb-to-db.php',data:{fb_name:FB_NAME,fb_id:FB_ID},success:function(response){var response=response.trim();if(response==='success_reg'){window.location="/profile.php"}
else if(response==='already_reg'){window.location="/index.php"}
else if(response==='banned'){alert("您的帳號因違反規定已被停權！")}}})})}else if(response.status==='not_authorized'){alert('您尚未點選確認新增我們的應用程式')}else{alert('您還沒有登入acebook，請再試一次')}})}
$(document).on('click','.facebook_reg',function(){FB.getLoginStatus(function(response){if(response.status==='connected'){FB.api('/me',{fields:'name'},function(response){var FB_NAME=response.name.trim();var FB_ID=response.id;$.ajax({type:'POST',url:'/register-fb-to-db.php',data:{fb_name:FB_NAME,fb_id:FB_ID},success:function(response){var response=response.trim();if(response==='success_reg'){window.location="/profile.php"}
else if(response==='already_reg'){window.location="/index.php"}
else if(response==='banned'){alert("您的帳號因違反規定已被停權！")}}})})}else if(response.status==='not_authorized'){window.location='https://www.facebook.com/v2.10/dialog/oauth?client_id=1895947000621168&redirect_uri=http://llamafun.com&response_type=token'}else{window.location='https://www.facebook.com/v2.10/dialog/oauth?client_id=1895947000621168&redirect_uri=http://llamafun.com&response_type=token'}})});var messageTimer='';var messageInterval=1;var newmsg=!0;function messageCount(){$.ajax({type:'GET',url:'/message-count.php',success:function(response){var response=response.trim();var count_format=/^[0-9]+$/;if(response==='logout'){clearInterval(messageTimer)}
else if(response==!1){$("#msg_count").hide()}
else if(response.match(count_format)){newmsg=!0;$("#msg_count").show();$("#msg_count").text(response)}}})}
$(".testdiv").perfectScrollbar();$('#notificationsBody').perfectScrollbar();$(document).on('click','.testdiv',function()
{$('.testdiv').prepend("<div class=content><img src=https://pbs.twimg.com/profile_images/624483066795290624/U_Qn1xLH_bigger.jpg width=50px height=50px alt=profpic> 123Developerdesks shared about something</div>")});$(document).on('click','#notifylink',function()
{$("#notificationContainer").fadeToggle(300);$("#msg_count").fadeOut("slow");if(newmsg==!0){var NFT_DATE='0';if($("#notificationsBody .nft-list").length){var NFT_LIST_ID=$("#notificationsBody .nft-list").first().attr('id').split('_');NFT_DATE=NFT_LIST_ID[2]}
newmsg=!1;$.ajax({type:'POST',url:'/message-show.php',data:{nft_date:NFT_DATE},success:function(response){$('#notificationsBody').prepend(response);$('#notificationsBody').perfectScrollbar('update');var listmsg=$('#notificationsBody .nft-list-msg');listmsg.each(function(){if(($(this).innerHeight())+10<$(this).prop('scrollHeight')){$(this).addClass('manual-ellipsis')}})}})}
return!1});$(document).on('click','.side-nft-msg',function(){$.ajax({url:'/message-side-nft.php',success:function(response){}})});$(document).on('click','.nft-readall',function(){$.ajax({url:'/message-read-all.php',success:function(response){$(".nft-list").removeClass('nft-unread')}})});$(document).on('click','.nft-list',function(){var NFT_LIST_ID=$(this).attr('id').split('_');var NFT_ID=NFT_LIST_ID[1];var READ_NFT=NFT_LIST_ID[3];if(READ_NFT=='0'){$(this).removeClass('nft-unread');$.ajax({type:'POST',url:'/message-read.php',data:{nft_id:NFT_ID},success:function(response){}})}});$(document).mouseup(function(e){var comments_dropdown=$(".comments-dropdown");var dropdown_content=$(".dropdown-content");if(!comments_dropdown.is(e.target)&&!dropdown_content.is(e.target)&&dropdown_content.has(e.target).length===0)
{dropdown_content.hide()}});$(document).on('click','.comment-nft-onoff',function(){var COM_NFTONOFF_ID=$(this).attr('id').split('_');var NFT_ONOFF=COM_NFTONOFF_ID[0];var THREAD_ID=COM_NFTONOFF_ID[1];$.ajax({type:'POST',url:'/comment-nft-onoff.php',data:{thread_id:THREAD_ID,nft_onoff:NFT_ONOFF},success:function(response){if(response==!0){if(NFT_ONOFF==='comment-nft-off'){$('#comment-nft-off_'+THREAD_ID).replaceWith("<a id='comment-nft-on_"+THREAD_ID+"' class='comment-nft-onoff' href='javascript: void(0)' >開啟通知</a>")}
else if(NFT_ONOFF==='comment-nft-on'){$('#comment-nft-on_'+THREAD_ID).replaceWith("<a id='comment-nft-off_"+THREAD_ID+"' class='comment-nft-onoff' href='javascript: void(0)' >關閉這個文章的通知</a>")}}}})});$(document).on('click','.comments-dropdown',function(e){e.preventDefault();var $this=$(this).parent().find('.dropdown-content');$(".dropdown-content").not($this).hide();$this.toggle()});$(document).click(function(){$("#notificationContainer").hide()});var NFTLOAD_FINISH=!0;if($(".notifications_page_body .nft-list").length){$(window).scroll(function(){if($(window).scrollTop()+$(window).height()>=Math.round($(document).height()*0.9)){if($('.notifications_page_body .nft_loding').length){var NFT_LIST_ID=$(".notifications_page_body .nft-list").last().attr('id').split('_');var NFT_DATE=NFT_LIST_ID[2];$('.notifications_page_body .nft_loding').show();if(NFTLOAD_FINISH===!0){NFTLOAD_FINISH=!1;$.ajax({type:'POST',url:'/message-show-more.php',data:{nft_date:NFT_DATE},success:function(html){$('.notifications_page_body .nft_loding').hide();$('.notifications_page_body .nft_loding').replaceWith(html);NFTLOAD_FINISH=!0}})}}}})}
$('#notificationsBody').bind('scroll',function(){if(Math.round($(this).scrollTop()+$(this).innerHeight())>=Math.round($(this)[0].scrollHeight*0.90)){if($('#notificationsBody .nft_loding').length){var NFT_LIST_ID=$("#notificationsBody .nft-list").last().attr('id').split('_');var NFT_DATE=NFT_LIST_ID[2];$('#notificationsBody .nft_loding').show();if(NFTLOAD_FINISH===!0){NFTLOAD_FINISH=!1;$.ajax({type:'POST',url:'/message-show-more.php',data:{nft_date:NFT_DATE},success:function(html){$('#notificationsBody .nft_loding').hide();$('#notificationsBody .nft_loding').replaceWith(html);$('#notificationsBody').perfectScrollbar('update');var listmsg=$('#notificationsBody .nft-list-msg');listmsg.each(function(){if(($(this).innerHeight())+10<$(this).prop('scrollHeight')){$(this).addClass('manual-ellipsis')}});NFTLOAD_FINISH=!0}})}}}});$(document).on('click','#notificationContainer',function(){return!1});$(document).on('click','#notificationsBody a',function(){var url=this;setTimeout(function(){window.location=url},100)});$("#notificationFooter").click(function(){window.location="/member_notifications.php"});if($("#msg_count").length){messageTimer=setInterval(function(){messageCount()},messageInterval*1000)}
$(document).on('click','.logout_btn',function(){clearInterval(messageTimer)});$(document).on('click','.linebtn',function(){var url=$(this).attr('alt');window.open('https://timeline.line.me/social-plugin/share?url='+encodeURIComponent(url),"_blank","toolbar=yes,location=yes,directories=no,status=no, menubar=yes,scrollbars=yes,resizable=no, copyhistory=yes,width=600,height=500")});$(document).on('click','.facebook_share',function(){var url=$(this).attr('alt');FB.ui({method:'share',display:'popup',href:url,},function(response){})});$(document).on('click','.registerbtn',function(){$('body').css('overflow','hidden');$('.register_popup').css('display','block')});$(document).on('click','.register_popup-close',function(){$('body').css('overflow','auto');$('.register_popup').css('display','none')});$(document).on('click','.register-to-login',function(){$('.register_popup').css('display','none');$('.login_popup').css('display','block')});var reg_username_correct=!1;var reg_email_correct=!1;var reg_pw_correct=!1;var reg_pw_recheck_correct=!1;$(document).on('keyup change','#register_username',function(){$('#error_username').css('visibility','visible');document.getElementById("error_username").innerHTML="　";var username_format=/^[\u4e00-\u9fa5\w-]+$/;var USERNAME=document.getElementById("register_username").value;if(USERNAME.length<1){document.getElementById("error_username").innerHTML="暱稱不能為空喔！";reg_username_correct=!1}
else{if(USERNAME.length>12){document.getElementById("error_username").innerHTML="暱稱只能小於12個字！";reg_username_correct=!1}
else{if(!USERNAME.match(username_format)){document.getElementById("error_username").innerHTML="不能使用注音　符號只能使用-或_";reg_username_correct=!1}
else{$.ajax({type:'POST',url:'/register-check-username.php',data:{username:USERNAME},success:function(response){if(response==!0){reg_username_correct=!0;document.getElementById("error_username").innerHTML="　"}
else{reg_username_correct=!1;document.getElementById("error_username").innerHTML="暱稱有人用過了喔！"}}})}}}});$(document).on('keyup change','#register_email',function(){$('#error_email').css('visibility','visible');document.getElementById("error_email").innerHTML="　";var mail_format=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;var EMAIL=document.getElementById("register_email").value;if(EMAIL.length<1){document.getElementById("error_email").innerHTML="信箱不能為空";reg_email_correct=!1}
else{if(!EMAIL.match(mail_format)){document.getElementById("error_email").innerHTML="信箱格式不正確";reg_email_correct=!1}
else{$.ajax({type:'POST',url:'/register-check-email.php',data:{email:EMAIL},success:function(response){if(response==!0){reg_email_correct=!0;document.getElementById("error_email").innerHTML="　"}
else{reg_email_correct=!1;document.getElementById("error_email").innerHTML="信箱有人用過了喔！"}}})}}});$(document).on('keyup change','#register_password',function(){$('#error_password').css('visibility','visible');document.getElementById("error_password").innerHTML="　";document.getElementById("error_password_check").innerHTML="　";var PASSWORD=document.getElementById("register_password").value;$("#register_password_check").val('');if(PASSWORD.length<1){document.getElementById("error_password").innerHTML="密碼不能為空";reg_pw_correct=!1}
else{if(PASSWORD.length<8||PASSWORD.length>20){document.getElementById("error_password").innerHTML="密碼長度為8~20個字喔";reg_pw_correct=!1}
else{document.getElementById("error_password").innerHTML="　";reg_pw_correct=!0}}});$(document).on('keyup change','#register_password_check',function(){$('#error_password_check').css('visibility','visible');document.getElementById("error_password_check").innerHTML="　";var PASSWORD=document.getElementById("register_password").value;var PASSWORD_CHECK=document.getElementById("register_password_check").value;if(PASSWORD!=PASSWORD_CHECK){document.getElementById("error_password_check").innerHTML="密碼不相符喔！";reg_pw_recheck_correct=!1}
else{document.getElementById("error_password_check").innerHTML="　";reg_pw_recheck_correct=!0}});$(document).on('click','.popup_registerbtn',function(){if(reg_username_correct==!0&&reg_email_correct==!0&&reg_pw_correct==!0&&reg_pw_recheck_correct==!0){if(reCAPTCHA_REG_STATUS===!1){$('#register_message').css('visibility','visible');document.getElementById("register_message").innerHTML="請點選驗證"}
else if(reCAPTCHA_REG_STATUS===!0){var USERNAME=document.getElementById("register_username").value;var EMAIL=document.getElementById("register_email").value;var PASSWORD=document.getElementById("register_password").value;$.ajax({type:'POST',url:'/register-to-db.php',data:{username:USERNAME,email:EMAIL,password:PASSWORD,recaptcha_reg_callback:reCAPTCHA_REG_CALLBACK},success:function(response){if(response==!0){reCAPTCHA_REG_STATUS=!1;reCAPTCHA_REG_CALLBACK=null;window.location="/index.php"}
else{reCAPTCHA_REG_STATUS=!1;reCAPTCHA_REG_CALLBACK=null;grecaptcha.reset(reCAPTCHA_REG);$('#register_message').css('visibility','visible');document.getElementById("register_message").innerHTML="註冊失敗！請再試一次~"}}})}}});$(document).on('click','.loginbtn',function(){$('body').css('overflow','hidden');$('.login_popup').css('display','block')});$(document).on('click','.login-to-register',function(){$('.login_popup').css('display','none');$('.register_popup').css('display','block')});$(document).on('click','.login_popup-close',function(){$('body').css('overflow','auto');$('.login_popup').css('display','none')});$(document).on('click','.popup_loginbtn',function(){var mail_format=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;var account_format=/^[0-9a-zA-Z]+$/;var EMAIL=document.getElementById("login_email").value;var PASSWORD=document.getElementById("login_password").value;var all_format_correct=!0;if(EMAIL.length<1){all_format_correct=!1}
if(PASSWORD.length<1){all_format_correct=!1}
if(all_format_correct==!0){if(reCAPTCHA_LOGIN_STATUS===!1){$('#login_message').css('visibility','visible');document.getElementById("login_message").innerHTML="請點選驗證"}
else if(reCAPTCHA_LOGIN_STATUS===!0){$.ajax({type:'POST',url:'/login-db.php',data:{email:EMAIL,password:PASSWORD,recaptcha_login_callback:reCAPTCHA_LOGIN_CALLBACK},success:function(response){if(response==!0){reCAPTCHA_LOGIN_STATUS=!1;reCAPTCHA_LOGIN_CALLBACK=null;$("#login_form").submit()}
else{reCAPTCHA_LOGIN_STATUS=!1;reCAPTCHA_LOGIN_CALLBACK=null;grecaptcha.reset(reCAPTCHA_LOGIN);$('#login_message').css('visibility','visible');document.getElementById("login_message").innerHTML=response}}})}}});$(document).on('click','.forgotpw',function(){$('.login_popup').css('display','none');$('#forgotpw_message').css('visibility','hidden');document.getElementById("forgotpw_message").innerHTML="MSG";$('.forgotpw-finished').css('display','none');$('.forgotpw-card').css('display','block');$('.forgotpw_popup').css('display','block')});$(document).on('click','.forgotpw-card-close',function(){$('body').css('overflow','auto');$('.forgotpw_popup').css('display','none')});$(document).on('click','.forgotpw-submit',function(){var mail_format=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;var EMAIL=document.getElementById("forgotpw_email").value;var all_format_correct=!0;if(EMAIL.length<1){$('#forgotpw_message').css('visibility','visible');document.getElementById("forgotpw_message").innerHTML="請輸入信箱";all_format_correct=!1}
else{if(!EMAIL.match(mail_format)){$('#forgotpw_message').css('visibility','visible');document.getElementById("forgotpw_message").innerHTML="信箱格式不正確";all_format_correct=!1}}
if(all_format_correct==!0){$('#forgotpw_message').css('visibility','visible');document.getElementById("forgotpw_message").innerHTML="處理中...";$(".forgotpw-card *").prop('disabled',!0);$.ajax({type:'POST',url:'/forgotpw.php',data:{email:EMAIL},success:function(response){var response=response.trim();if(response==="success"){$('.forgotpw-card').css('display','none');$('#forgotpw_email').val('');$('.forgotpw-finished').css('display','block');$(".forgotpw-card *").prop('disabled',!1)}
else if(response==="notfound"){document.getElementById("forgotpw_message").innerHTML="此用戶不存在";$(".forgotpw-card *").prop('disabled',!1)}
else if(response==="facebook"){document.getElementById("forgotpw_message").innerHTML="因使用FB註冊，並無登入密碼";$(".forgotpw-card *").prop('disabled',!1)}
else{document.getElementById("forgotpw_message").innerHTML="送出失敗、請再試一次";$(".forgotpw-card *").prop('disabled',!1)}}})}});$(document).on('click','.likebtn',function(){var LIKEBTN_ID=$(this).attr('id').split('_');var LIKE_UNLILE=LIKEBTN_ID[0];var THREAD_ID=LIKEBTN_ID[1];var MEMBER_ID=LIKEBTN_ID[2];var LOGGEDIN_CHECK=LIKEBTN_ID[3];if(LIKE_UNLILE==="likebtn"){if(LOGGEDIN_CHECK!=!0){$('body').css('overflow','hidden');$('.login_popup').css('display','block')}
else{document.getElementById("likebtn_"+THREAD_ID+"_"+MEMBER_ID+"_"+LOGGEDIN_CHECK).setAttribute("id","unlikebtn_"+THREAD_ID+"_"+MEMBER_ID+"_"+LOGGEDIN_CHECK);$("#unlikebtn_"+THREAD_ID+"_"+MEMBER_ID+"_"+LOGGEDIN_CHECK).removeClass("like-gray").addClass("unlike-blue");$.ajax({type:'POST',url:'/thread-like.php',data:{thread_id:THREAD_ID,member_id:MEMBER_ID},success:function(html){$('#likecount_'+THREAD_ID).replaceWith(html)}})}}
else{document.getElementById("unlikebtn_"+THREAD_ID+"_"+MEMBER_ID+"_"+LOGGEDIN_CHECK).setAttribute("id","likebtn_"+THREAD_ID+"_"+MEMBER_ID+"_"+LOGGEDIN_CHECK);$("#likebtn_"+THREAD_ID+"_"+MEMBER_ID+"_"+LOGGEDIN_CHECK).removeClass("unlike-blue").addClass("like-gray");$.ajax({type:'POST',url:'/thread-unlike.php',data:{thread_id:THREAD_ID,member_id:MEMBER_ID},success:function(html){$('#likecount_'+THREAD_ID).replaceWith(html)}})}});var report_title=null;var reprot_comment=null;var report_type=null;var report_member_id=null;var report_thread_id=null;var report_comment_id=null;$(document).on('click','.thread-com-report',function(){var REPORT_ID=$(this).attr('id').split('_');var LOGGEDIN_CHECK=REPORT_ID[2];if(LOGGEDIN_CHECK!=!0){$('body').css('overflow','hidden');$('.login_popup').css('display','block')}
else{var TYPE=REPORT_ID[0];if(TYPE==='thread-report'){report_thread_id=REPORT_ID[1];report_type="檢舉-文章"}
else if(TYPE==='comments-report'){report_comment_id=REPORT_ID[4];report_type="檢舉-留言"}
$('.report_finished').hide();$('.report-card').css('display','block');$('body').css('overflow','hidden');$('.report_popup').css('display','block')}});$(document).on('click','.report_popup-close',function(){$('body').css('overflow','auto');$('.report_popup').hide();$('.popup_report-next-unchecked').removeClass("popup_report-next report_submitting");$(".popup_report-next-unchecked").text('送出');$('.report-radio-other').val('');$(".report-radio").find("input:radio").prop("checked",!1).end().buttonset("refresh")});$(document).on('click','.popup_report-next',function(){var formdata=new FormData();formdata.append('report_type',report_type);if(report_type=='檢舉-文章'){formdata.append('report_com_thread_id',report_thread_id)}
else if(report_type=='檢舉-留言'){formdata.append('report_com_thread_id',report_comment_id)}
var report_reason=$('input[name=report-radio]:checked').val();if($('input[name=report-radio]:checked').val()==="其他"){report_reason="其他："+$('.report-radio-other').val()}
formdata.append('report_reason',report_reason);$(".report-card *").prop('disabled',!0);$(".popup_report-next-unchecked").addClass("report_submitting");$(".popup_report-next-unchecked").text('傳送中..');$.ajax({type:'POST',url:'/send-report.php',data:formdata,processData:!1,contentType:!1,success:function(response){if(response==!0){$('.report-card').hide();$('.report_finished').css('display','block');$(".report-card *").prop('disabled',!1);$('.popup_report-next-unchecked').removeClass("popup_report-next report_submitting");$(".popup_report-next-unchecked").text('送出');$('.report-radio-other').val('');$(".report-radio").find("input:radio").prop("checked",!1).end().buttonset("refresh")}
else{alert('送出失敗，請再試一次');$(".report-card *").prop('disabled',!1);$('.popup_report-next-unchecked').removeClass("report_submitting");$(".popup_report-next-unchecked").text('送出')}}})});$(document).on('click','input[name=report-radio]',function(){$('.popup_report-next-unchecked').addClass("popup_report-next")});var comment_uploadtype=null;var comment_imgfile=null;var comment_imgurl=null;var comment_imgtype=null;var comment_image_check=!1;$(document).on('change','.comment-image-file',function(){comment_image_check=!1;var img_file=$(this)[0].files[0];var img_filename=img_file.name;var COM_IMGFILE_ID=$(this).attr('id').split('_');var THREAD_ID=COM_IMGFILE_ID[1];var LOGGEDIN_CHECK=COM_IMGFILE_ID[2];if(typeof(img_file)!="undefined"&&img_file!=null){var img_type=img_file.type;if(img_type==="image/png"||img_type==="image/jpeg"||img_type==="image/jpg"||img_type==="image/gif"){var img_size=img_file.size/1024/1024;if(img_size<=10){comment_image_check=!0;comment_imgtype=img_type;comment_uploadtype="file";comment_imgfile=img_file;$('#comment-msg_'+THREAD_ID).text(img_filename);$('#comment-upload-file_'+THREAD_ID).hide();$('#comment-upload-cancel_'+THREAD_ID+'_'+LOGGEDIN_CHECK).css('display','inline-block');$('#comment-image-url_'+THREAD_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!0)}
else{alert("Daddy Too Big!!!!  最大10MB喔!!!");$("#comment-image-file_"+THREAD_ID+'_'+LOGGEDIN_CHECK).val('')}}
else{alert("只能上傳圖片檔喔！JPG、PNG、GIF");$("#comment-image-file_"+THREAD_ID+'_'+LOGGEDIN_CHECK).val('')}}});$(document).on('click','.comment-upload-cancel',function(){comment_image_check=!1;var COM_CANCEL_ID=$(this).attr('id').split('_');var THREAD_ID=COM_CANCEL_ID[1];var LOGGEDIN_CHECK=COM_CANCEL_ID[2];$("#comment-image-file_"+THREAD_ID+'_'+LOGGEDIN_CHECK).val('');$('#comment-upload-cancel_'+THREAD_ID+'_'+LOGGEDIN_CHECK).hide();$('#comment-upload-file_'+THREAD_ID).css('display','inline-block');$('#comment-image-url_'+THREAD_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-msg_'+THREAD_ID).text("")});var globalTimeout_comment_img=null;$(document).on('keyup paste','.comment-image-url',function(){comment_image_check=!1;var COM_IMGURL_ID=$(this).attr('id').split('_');var THREAD_ID=COM_IMGURL_ID[1];var LOGGEDIN_CHECK=COM_IMGURL_ID[2];if(LOGGEDIN_CHECK==!0){if(globalTimeout_comment_img!=null){clearTimeout(globalTimeout_comment_img)}
globalTimeout_comment_img=setTimeout(function(){globalTimeout_comment_img=null;var comment_image_url=$("#comment-image-url_"+THREAD_ID+"_"+LOGGEDIN_CHECK).val();if(comment_image_url.length===0){$('#comment-upload-file_'+THREAD_ID).removeClass("comment-upload-disabled");$('#comment-image-file_'+THREAD_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).removeClass("submit-comment-disabled");$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-msg_'+THREAD_ID).text('')}
else{$('#comment-upload-file_'+THREAD_ID).addClass("comment-upload-disabled");$('#comment-image-file_'+THREAD_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!0);$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).addClass("submit-comment-disabled");$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!0);$('#comment-msg_'+THREAD_ID).text('載入中...');$.ajax({type:'POST',url:'/uploadimg-url-check.php',data:{image_url:comment_image_url},success:function(response){var response=response.trim();if(response==="image/png"||response==="image/jpeg"||response==="image/jpg"||response==="image/gif"){var img_type=response;comment_image_check=!0;comment_imgtype=img_type;comment_uploadtype="url";comment_imgurl=comment_image_url;$('#comment-msg_'+THREAD_ID).text("");$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).removeClass("submit-comment-disabled");$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1)}
else if(response==='網址錯誤'){$('#comment-msg_'+THREAD_ID).text('網址錯誤喔！')}
else if(response==='圖片太大'){$('#comment-msg_'+THREAD_ID).text('上限為10MB喔！')}
else if(response==='不支援網址'){$('#comment-msg_'+THREAD_ID).text('只能使用圖片網址喔！')}}})}},500)}
else{$('body').css('overflow','hidden');$('.login_popup').css('display','block')}});$(document).on('keyup','.textarea-comment',function(){$(this).css('height','auto');$(this).height($(this).prop('scrollHeight')-4+'px')});$(document).on('click','.textarea-comment',function(){});$(document).on('click','.submit-comment',function(){var SEND_COM_ID=$(this).attr('id').split('_');var LOGGEDIN_CHECK=SEND_COM_ID[2];if(LOGGEDIN_CHECK!=!0){$('body').css('overflow','hidden');$('.login_popup').css('display','block')}
else{var THREAD_ID=SEND_COM_ID[1];var COMMENT=$("textarea#textarea-comment_"+THREAD_ID).val();var format=/(?!^\s+$)^(.|\n)+$/;var format_correct=!0;var formdata=new FormData();if(COMMENT.length<1){format_correct=!1}
else{if(!COMMENT.match(format)){format_correct=!1;COMMENT=""}
if(COMMENT.length>250){format_correct=!1;alert('文字限制為250字喔！')}}
formdata.append('comment_uploadtype','none');formdata.append('comment_imgtype','none');if(comment_image_check===!0){format_correct=!0;formdata.append('comment_uploadtype',comment_uploadtype);formdata.append('comment_imgtype',comment_imgtype);if(comment_uploadtype==="file"){formdata.append('comment_uploadimg',comment_imgfile)}
else if(comment_uploadtype==="url"){formdata.append('comment_uploadimg',comment_imgurl)}}
if(format_correct===!0){formdata.append('thread_id',THREAD_ID);formdata.append('comment',COMMENT);$("textarea#textarea-comment_"+THREAD_ID).prop('disabled',!0);$('#comment-image-url_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!0);$('#comment-image-file_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!0);$('#comment-upload-file_'+THREAD_ID).addClass("comment-upload-disabled");$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!0);$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).addClass("comment-upload-disabled");$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).addClass("submit-comment-disabled");$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!0);$('#comment-msg_'+THREAD_ID).hide();$('#send-comment-msg_'+THREAD_ID).show();$.ajax({type:'POST',url:'/send-comment.php',data:formdata,processData:!1,contentType:!1,success:function(response){if(response!=!1){comment_image_check=!1;comment_imgtype=null;comment_imgfile=null;comment_imgurl=null;$("#comment-image-file_"+THREAD_ID+'_'+LOGGEDIN_CHECK).val('');$('#comment-upload-cancel_'+THREAD_ID+'_'+LOGGEDIN_CHECK).hide();$('#comment-upload-file_'+THREAD_ID).css('display','inline-block');$("#comment-image-url_"+THREAD_ID+"_"+LOGGEDIN_CHECK).val('');$("#textarea-comment_"+THREAD_ID).val('');$("#textarea-comment_"+THREAD_ID).height('25px');$('#comment-msg_'+THREAD_ID).text("");$('#div-comments_'+THREAD_ID).show();$('#div-comments_'+THREAD_ID).prepend(response);$('#comment-image-file_'+THREAD_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-upload-file_'+THREAD_ID).removeClass("comment-upload-disabled");$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).removeClass("comment-upload-disabled");$('#comment-image-url_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1)}
else{alert("送出留言失敗！ 請再試一次");if(comment_uploadtype==="file"){$('#comment-image-file_'+THREAD_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-upload-file_'+THREAD_ID).removeClass("comment-upload-disabled");$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).removeClass("comment-upload-disabled")}
else if(comment_uploadtype==="url"){$('#comment-image-url_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1)}
else{$('#comment-image-file_'+THREAD_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-upload-file_'+THREAD_ID).removeClass("comment-upload-disabled");$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-upload-cancel_'+THREAD_ID+"_"+LOGGEDIN_CHECK).removeClass("comment-upload-disabled");$('#comment-image-url_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1)}}
$("textarea#textarea-comment_"+THREAD_ID).prop('disabled',!1);$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).removeClass("submit-comment-disabled");$('#submit-comment_'+THREAD_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-msg_'+THREAD_ID).show();$('#send-comment-msg_'+THREAD_ID).hide()}})}}});$(document).on('click','.show_more',function(){var THREAD_ID_COMMENTS_DATE=$(this).attr('id').split('_');var THREAD_ID=THREAD_ID_COMMENTS_DATE[1];var COMMENTS_DATE=THREAD_ID_COMMENTS_DATE[2];var DIVREPLY_COM_ID=THREAD_ID_COMMENTS_DATE[3];var NFT_RCID=THREAD_ID_COMMENTS_DATE[4];var HOT_COM_ID=THREAD_ID_COMMENTS_DATE[5];$(this).hide();$('#loding-'+THREAD_ID).show();$.ajax({type:'POST',url:'/show-more-comments.php',data:{thread_id:THREAD_ID,comments_date:COMMENTS_DATE,divreply_reply_com_id:DIVREPLY_COM_ID,nft_rcid:NFT_RCID,hot_com_id:HOT_COM_ID},success:function(html){$('#show_more_main'+THREAD_ID+"_"+DIVREPLY_COM_ID).replaceWith(html)}})});$(document).on('click','.reply_showmore',function(){var reply_showmore_id=$(this).attr('id').split('_');var THREAD_ID=reply_showmore_id[1];var COMMENTS_DATE=reply_showmore_id[2];var DIVREPLY_COM_ID=reply_showmore_id[3];var REPLY_COM_ID=reply_showmore_id[4];var REPLY_RCID=reply_showmore_id[5];var NFT_TARGET_RCID=reply_showmore_id[6];$('.reply-showmore_'+REPLY_COM_ID).hide();$('#loding-'+REPLY_COM_ID).show();$.ajax({type:'POST',url:'/show-more-reply.php',data:{thread_id:THREAD_ID,comments_date:COMMENTS_DATE,divreply_reply_com_id:DIVREPLY_COM_ID,reply_com_id:REPLY_COM_ID,reply_rcid:REPLY_RCID,nft_target_rcid:NFT_TARGET_RCID},success:function(html){$('#reply_showmore_main'+REPLY_COM_ID).replaceWith(html)}})});$(document).on('click','.comment-gif-video',function(){var video_src=$(this).find('source').attr("src");$('body').css('overflow','hidden');$('.comment_img_popup').css('display','block');$('.com_popup_video').first().attr('src',video_src);$('.com_popup_img-div').hide();$('.com_popup_video-div').show()});$(document).on('click','.comment-image',function(){var img_src=$(this).attr("src");$('body').css('overflow','hidden');$('.comment_img_popup').css('display','block');$('.com_popup_img').attr('src',img_src);$('.com_popup_img-div').show();$('.com_popup_video-div').hide()});$(document).on('click','.comment_img_popup-close',function(){$('body').css('overflow','auto');$('.comment_img_popup').css('display','none')});$(document).on('click','.rwd-comment_img_popup-close',function(){$('body').css('overflow','auto');$('.comment_img_popup').css('display','none')});var AT_MEMBER_ID;var NFT_REPLY_RCID;$(document).on('click','.replybtn',function(){$('.divreply-form').hide();var REPLYBTN_ID=$(this).attr('id').split('_');var REPLY_COM_ID=REPLYBTN_ID[1];AT_MEMBER_ID=REPLYBTN_ID[2];var USERNAME=REPLYBTN_ID[3];NFT_REPLY_RCID=REPLYBTN_ID[4];$('#divreply-form_'+REPLY_COM_ID).show();document.getElementById("replyto_"+REPLY_COM_ID).innerHTML="回覆至："+USERNAME});var reply_uploadtype=null;var reply_imgfile=null;var reply_imgurl=null;var reply_imgtype=null;var reply_image_check=!1;$(document).on('change','.reply-image-file',function(){reply_image_check=!1;var img_file=$(this)[0].files[0];var img_filename=img_file.name;var REPLY_IMGFILE_ID=$(this).attr('id').split('_');var REPLY_COM_ID=REPLY_IMGFILE_ID[1];var LOGGEDIN_CHECK=REPLY_IMGFILE_ID[2];if(typeof(img_file)!="undefined"&&img_file!=null){var img_type=img_file.type;if(img_type==="image/png"||img_type==="image/jpeg"||img_type==="image/jpg"||img_type==="image/gif"){var img_size=img_file.size/1024/1024;if(img_size<=10){reply_image_check=!0;reply_imgtype=img_type;reply_uploadtype="file";reply_imgfile=img_file;$('#comment-reply-msg_'+REPLY_COM_ID).text(img_filename);$('#reply-upload-file_'+REPLY_COM_ID).hide();$('#reply-upload-cancel_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).css('display','inline-block');$('#reply-image-url_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!0)}
else{alert("Daddy Too Big!!!!  最大10MB喔!!!");$("#reply-image-file_"+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).val('')}}
else{alert("只能上傳圖片檔喔！JPG、PNG、GIF");$("#reply-image-file_"+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).val('')}}});$(document).on('click','.reply-upload-cancel',function(){reply_image_check=!1;var REPLY_CANCEL_ID=$(this).attr('id').split('_');var REPLY_COM_ID=REPLY_CANCEL_ID[1];var LOGGEDIN_CHECK=REPLY_CANCEL_ID[2];$("#reply-image-file_"+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).val('');$('#reply-upload-cancel_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).hide();$('#reply-upload-file_'+REPLY_COM_ID).css('display','inline-block');$('#reply-image-url_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#comment-reply-msg_'+REPLY_COM_ID).text('')});var globalTimeout_reply_img=null;$(document).on('keyup paste','.reply-image-url',function(){reply_image_check=!1;var REPLY_IMGURL_ID=$(this).attr('id').split('_');var REPLY_COM_ID=REPLY_IMGURL_ID[1];var LOGGEDIN_CHECK=REPLY_IMGURL_ID[2];if(LOGGEDIN_CHECK==!0){if(globalTimeout_reply_img!=null){clearTimeout(globalTimeout_reply_img)}
globalTimeout_reply_img=setTimeout(function(){globalTimeout_reply_img=null;var reply_image_url=$("#reply-image-url_"+REPLY_COM_ID+"_"+LOGGEDIN_CHECK).val();if(reply_image_url.length===0){$('#reply-upload-file_'+REPLY_COM_ID).removeClass("reply-upload-disabled");$('#reply-image-file_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('.submit-reply').removeClass("submit-reply-disabled");$('.submit-reply').prop('disabled',!1);$('#comment-reply-msg_'+REPLY_COM_ID).text('')}
else{$('#reply-upload-file_'+REPLY_COM_ID).addClass("reply-upload-disabled");$('#reply-image-file_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!0);$('.submit-reply').addClass("submit-reply-disabled");$('.submit-reply').prop('disabled',!0);$('#comment-reply-msg_'+REPLY_COM_ID).text('載入中...');$.ajax({type:'POST',url:'/uploadimg-url-check.php',data:{image_url:reply_image_url},success:function(response){var response=response.trim();if(response==="image/png"||response==="image/jpeg"||response==="image/jpg"||response==="image/gif"){var img_type=response;reply_image_check=!0;reply_imgtype=img_type;reply_uploadtype="url";reply_imgurl=reply_image_url;$('#comment-reply-msg_'+REPLY_COM_ID).text('');$('.submit-reply').removeClass("submit-reply-disabled");$('.submit-reply').prop('disabled',!1)}
else if(response==='網址錯誤'){$('#comment-reply-msg_'+REPLY_COM_ID).text('網址錯誤喔！')}
else if(response==='圖片太大'){$('#comment-reply-msg_'+REPLY_COM_ID).text('上限為10MB喔！')}
else if(response==='不支援網址'){$('#comment-reply-msg_'+REPLY_COM_ID).text('只能使用圖片網址喔！')}}})}},500)}
else{$('body').css('overflow','hidden');$('.login_popup').css('display','block')}});$(document).on('keyup','.textarea-reply',function(){$(this).css('height','auto');$(this).height($(this).prop('scrollHeight')-4+'px')});$(document).on('keyup','.textarea-reply',function(){});$(document).on('click','.submit-reply',function(){var REPLYBTN_ID=$(this).attr('id').split('_');var LOGGEDIN_CHECK=REPLYBTN_ID[3];if(LOGGEDIN_CHECK!=!0){$('body').css('overflow','hidden');$('.login_popup').css('display','block')}
else{var REPLY_COM_ID=REPLYBTN_ID[1];var THREAD_ID=REPLYBTN_ID[2];var COMMENT_REPLY=$("textarea#textarea-reply_"+REPLY_COM_ID).val();var reply_format=/(?!^\s+$)^(.|\n)+$/;var reply_format_correct=!0;var formdata=new FormData();if(COMMENT_REPLY.length<1){reply_format_correct=!1}
else{if(!COMMENT_REPLY.match(reply_format)){reply_format_correct=!1;COMMENT_REPLY=""}
if(COMMENT_REPLY.length>250){reply_format_correct=!1;alert('文字限制為250字喔！')}}
formdata.append('reply_uploadtype','none');formdata.append('reply_imgtype','none');if(reply_image_check===!0){reply_format_correct=!0;formdata.append('reply_uploadtype',reply_uploadtype);formdata.append('reply_imgtype',reply_imgtype);if(reply_uploadtype==="file"){formdata.append('reply_uploadimg',reply_imgfile)}
else if(reply_uploadtype==="url"){formdata.append('reply_uploadimg',reply_imgurl)}}
if(reply_format_correct===!0){formdata.append('reply_com_id',REPLY_COM_ID);formdata.append('thread_id',THREAD_ID);formdata.append('at_member_id',AT_MEMBER_ID);formdata.append('comment_reply',COMMENT_REPLY);formdata.append('nft_reply_rcid',NFT_REPLY_RCID);$(".divreply-form *").prop('disabled',!0);$('#reply-upload-file_'+REPLY_COM_ID).addClass("reply-upload-disabled");$('#reply-upload-cancel_'+REPLY_COM_ID+"_"+LOGGEDIN_CHECK).addClass("reply-upload-disabled");$('.submit-reply').addClass("submit-reply-disabled");$('#comment-reply-msg_'+REPLY_COM_ID).hide();$('#send-reply-msg_'+REPLY_COM_ID).show();$.ajax({type:'POST',url:'/comment-reply.php',data:formdata,processData:!1,contentType:!1,success:function(response){if(response!=!1){reply_image_check=!1;reply_uploadtype=null;reply_imgfile=null;reply_imgurl=null;$("#reply-image-file_"+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).val('');$('#reply-upload-cancel_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).hide();$('#reply-upload-file_'+REPLY_COM_ID).css('display','inline-block');$("#reply-image-url_"+REPLY_COM_ID+"_"+LOGGEDIN_CHECK).val('');$("textarea#textarea-reply_"+REPLY_COM_ID).val('');　
$("textarea#textarea-reply_"+REPLY_COM_ID).height('25px');$('#comment-reply-msg_'+REPLY_COM_ID).text('');　
$(".divreply-form *").prop('disabled',!1);$('#reply-upload-file_'+REPLY_COM_ID).removeClass("reply-upload-disabled");$('#reply-upload-cancel_'+REPLY_COM_ID+"_"+LOGGEDIN_CHECK).removeClass("reply-upload-disabled");$('.divreply-form').hide();$('#div-reply_'+REPLY_COM_ID).append(response)}
else{alert("送出留言失敗！ 請再試一次");$("textarea#textarea-reply_"+REPLY_COM_ID).prop('disabled',!1);if(reply_uploadtype==="file"){$("#reply-image-file_"+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#reply-upload-file_'+REPLY_COM_ID).removeClass("reply-upload-disabled");$('#reply-upload-cancel_'+REPLY_COM_ID+'_'+LOGGEDIN_CHECK).prop('disabled',!1);$('#reply-upload-cancel_'+REPLY_COM_ID+"_"+LOGGEDIN_CHECK).removeClass("reply-upload-disabled")}
else if(reply_uploadtype==="url"){$("#reply-image-url_"+REPLY_COM_ID+"_"+LOGGEDIN_CHECK).prop('disabled',!1)}}
$('.submit-reply').removeClass("submit-reply-disabled");$('.submit-reply').prop('disabled',!1);$('#comment-reply-msg_'+REPLY_COM_ID).show();$('#send-reply-msg_'+REPLY_COM_ID).hide()}})}}});$(document).on('click','.comments-likebtn',function(){var COMLIKEBTN_ID=$(this).attr('id').split('_');var COMLIKE_UNLILE=COMLIKEBTN_ID[0];var REPLY_COM_ID=COMLIKEBTN_ID[1];var COM_MEMBER_ID=COMLIKEBTN_ID[2];var LOGGEDIN_CHECK=COMLIKEBTN_ID[3];if(COMLIKE_UNLILE==="comments-likebtn"){if(LOGGEDIN_CHECK!=!0){$('body').css('overflow','hidden');$('.login_popup').css('display','block')}
else{document.getElementById("comments-likebtn_"+REPLY_COM_ID+"_"+COM_MEMBER_ID+"_"+LOGGEDIN_CHECK).setAttribute("id","comments-unlikebtn_"+REPLY_COM_ID+"_"+COM_MEMBER_ID+"_"+LOGGEDIN_CHECK);$("#comments-unlikebtn_"+REPLY_COM_ID+"_"+COM_MEMBER_ID+"_"+LOGGEDIN_CHECK).removeClass("comlike_gray").addClass("comunlike_blue");$.ajax({type:'POST',url:'/comments-like.php',data:{reply_com_id:REPLY_COM_ID,comments_member_id:COM_MEMBER_ID},success:function(html){$('#commentslikecount_'+REPLY_COM_ID).replaceWith(html)}})}}
else{document.getElementById("comments-unlikebtn_"+REPLY_COM_ID+"_"+COM_MEMBER_ID+"_"+LOGGEDIN_CHECK).setAttribute("id","comments-likebtn_"+REPLY_COM_ID+"_"+COM_MEMBER_ID+"_"+LOGGEDIN_CHECK);$("#comments-likebtn_"+REPLY_COM_ID+"_"+COM_MEMBER_ID+"_"+LOGGEDIN_CHECK).removeClass("comunlike_blue").addClass("comlike_gray");$.ajax({type:'POST',url:'/comments-unlike.php',data:{reply_com_id:REPLY_COM_ID,comments_member_id:COM_MEMBER_ID},success:function(html){$('#commentslikecount_'+REPLY_COM_ID).replaceWith(html)}})}});$(document).on('click','.thread-nft-onoff',function(){var THREAD_NFTONOFF_ID=$(this).attr('id').split('_');var NFT_ONOFF=THREAD_NFTONOFF_ID[0];var THREAD_ID=THREAD_NFTONOFF_ID[1];$.ajax({type:'POST',url:'/thread-nft-onoff.php',data:{thread_id:THREAD_ID,nft_onoff:NFT_ONOFF},success:function(response){if(response==!0){if(NFT_ONOFF==='thread-nft-off'){$('#thread-nft-off_'+THREAD_ID).replaceWith("<a id='thread-nft-on_"+THREAD_ID+"' class='thread-nft-onoff nft-off' href='javascript: void(0)' >通知</a>")}
else if(NFT_ONOFF==='thread-nft-on'){$('#thread-nft-on_'+THREAD_ID).replaceWith("<a id='thread-nft-off_"+THREAD_ID+"' class='thread-nft-onoff' href='javascript: void(0)' >通知</a>")}}}})});var EDIT_SUBJECT=null;var SUBJECT_URL=null;var EDIT_THREAD_ID=null;$(document).on('click','.thread-edit',function(){if(!$(".thread_show").length){$('.thread-edit-submit').remove();$('.textarea_subject_edit').replaceWith("<div id='thread-title_"+EDIT_THREAD_ID+"' class='div-row thread_title'><a href='"+SUBJECT_URL+"' target=_blank>"+EDIT_SUBJECT+"</a></div>")}
else if($(".thread_show").length){$('.thread-edit-submit').remove();$('.textarea_subject_edit').replaceWith("<div id='thread-title_"+EDIT_THREAD_ID+"' class='div-row thread_title'>"+EDIT_SUBJECT+"</div>")}
var thread_edit_ID=$(this).attr('id').split('_');EDIT_THREAD_ID=thread_edit_ID[1];EDIT_SUBJECT=$("#thread-title_"+EDIT_THREAD_ID).text();SUBJECT_URL=$("#thread-title_"+EDIT_THREAD_ID).find('a:first').attr('href');$("#thread-title_"+EDIT_THREAD_ID).replaceWith("<textarea maxlength='60' class='textarea_subject_edit' id="+EDIT_THREAD_ID+" name='textarea_subject'></textarea> <a class='thread-edit-submit' href=javascript: void(0) >送出</a>");$("textarea.textarea_subject_edit").val(EDIT_SUBJECT)});$(document).on('click','.thread-edit-submit',function(){var SUBJECT=$("textarea.textarea_subject_edit").val();var format=/(?!^\s+$)^(.|\n)+$/;var format_correct=!0;var THREAD_ID=$('.textarea_subject_edit').attr('id');if(SUBJECT.length<1){format_correct=!1}
else{if(!SUBJECT.match(format)){format_correct=!1}}
if(format_correct==!0){$("textarea.textarea_subject_edit").val('');$.ajax({type:'POST',url:'/thread-edit.php',data:{thread_id:THREAD_ID,subject:SUBJECT},success:function(response){if(response!=!1){$('.thread-edit-submit').remove();if(!$(".thread_show").length){$('.textarea_subject_edit').replaceWith("<div id='thread-title_"+THREAD_ID+"' class='div-row thread_title'><a href='"+SUBJECT_URL+"' target=_blank>"+SUBJECT+"</a></div>");$(".thread-info-image #thread-title_"+EDIT_THREAD_ID+" a").text(SUBJECT)}
else{$('.textarea_subject_edit').replaceWith("<div id='thread-title_"+THREAD_ID+"' class='div-row thread_title'>"+SUBJECT+"</div>");$(".thread-info-image #thread-title_"+EDIT_THREAD_ID).text(SUBJECT)}}}})}});$(document).on('click','.thread-delete',function(){if(confirm("確定要刪除文章嗎？")){var thread_del_ID=$(this).attr('id').split('_');var THREAD_ID=thread_del_ID[1];$.ajax({type:'POST',url:'/thread-delete.php',data:{thread_id:THREAD_ID},success:function(response){if(response==!0){alert("文章刪除成功！");location.reload()}
else{alert("文章刪除失敗，請再試一次")}}})}});$(document).on('click','.comments-delete',function(){if(confirm("確定要刪除留言嗎？")){var comments_del_ID=$(this).attr('id').split('_');var REPLY_COM_ID=comments_del_ID[1];$.ajax({type:'POST',url:'/comments-delete.php',data:{reply_com_id:REPLY_COM_ID},success:function(response){if(response==!0){$('#comments-list_'+REPLY_COM_ID).remove()}}})}});$(document).on('click','.reply-delete',function(){if(confirm("確定要刪除留言嗎？")){var reply_del_ID=$(this).attr('id').split('_');var REPLY_COM_ID=reply_del_ID[1];$.ajax({type:'POST',url:'/comments-delete.php',data:{reply_com_id:REPLY_COM_ID},success:function(response){if(response==!0){$('#reply-list_'+REPLY_COM_ID).remove()}}})}});var edit_username_correct=!0;var edit_email_correct=!0;var edit_pw_original_correct=!1;var edit_pw_new_correct=!1;var edit_pw_newcheck_correct=!1;var edit_member_pic=!1;var edit_uploadtype=null;var edit_picfile=null;var edit_picurl=null;$(document).on('change','.profile-uploadpic',function(){edit_member_pic=!1;var member_pic=$(".profile-uploadpic")[0].files[0];var img_type=member_pic.type;var img_filename=member_pic.name;if(typeof(member_pic)!="undefined"&&member_pic!=null){if(img_type==="image/png"||img_type==="image/jpeg"||img_type==="image/jpg"||img_type==="image/gif"){var img_size=member_pic.size/1024/1024;if(img_size<=10){edit_member_pic=!0;edit_uploadtype="file";edit_picfile=member_pic;$('.profile-pic-msg').css('visibility','visible');$('.profile-pic-msg').text(img_filename);$('.profile-upload-file').hide();$('.profile-upload-cancel').css('display','inline-block');$('.profile-uploadpic-url').prop('disabled',!0)}
else{alert("Daddy Too Big!!!!  最大10MB喔!!!");$(".profile-uploadpic").val('')}}
else{alert("只能上傳圖片檔喔！JPG、PNG、GIF");$(".profile-uploadpic").val('')}}});$(document).on('click','.profile-upload-cancel',function(){edit_member_pic=!1;$(".profile-uploadpic").val('');$('.profile-upload-cancel').hide();$('.profile-upload-file').css('display','inline-block');$('.profile-uploadpic-url').prop('disabled',!1);$('.profile-pic-msg').css('visibility','hidden');$('.profile-pic-msg').text('URL')});var globalTimeout_profile_pic=null;$(document).on('keyup','.profile-uploadpic-url',function(){edit_member_pic=!1;if(globalTimeout_comment_img!=null){clearTimeout(globalTimeout_profile_pic)}
globalTimeout_profile_pic=setTimeout(function(){globalTimeout_profile_pic=null;var uploadpic_url=$(".profile-uploadpic-url").val();if(uploadpic_url.length===0){$('.profile-upload-file').removeClass("profile-upload-disabled");$(".profile-uploadpic").prop('disabled',!1);$('.submit-edit-profile').prop('disabled',!1);$('.profile-pic-msg').css('visibility','hidden');$('.profile-pic-msg').text('URL')}
else{$('.profile-upload-file').addClass("profile-upload-disabled");$(".profile-uploadpic").prop('disabled',!0);$('.submit-edit-profile').prop('disabled',!0);$('.profile-pic-msg').css('visibility','visible');$('.profile-pic-msg').text('載入中...');$.ajax({type:'POST',url:'/uploadimg-url-check.php',data:{image_url:uploadpic_url},success:function(response){var response=response.trim();if(response==="image/png"||response==="image/jpeg"||response==="image/jpg"||response==="image/gif"){edit_member_pic=!0;edit_uploadtype="url";edit_picurl=uploadpic_url;$('.profile-pic-msg').css('visibility','hidden');$('.profile-pic-msg').text("URL");$('.submit-edit-profile').prop('disabled',!1)}
else if(response==='網址錯誤'){$('.profile-pic-msg').css('visibility','visible');$('.profile-pic-msg').text('網址錯誤喔！')}
else if(response==='圖片太大'){$('.profile-pic-msg').css('visibility','visible');$('.profile-pic-msg').text('上限為10MB喔！')}
else if(response==='不支援網址'){$('.profile-pic-msg').css('visibility','visible');$('.profile-pic-msg').text('只能使用圖片網址喔！')}}})}},500)});$(document).on('keyup change','#profile-edit-username',function(){var username_format=/^[\u4e00-\u9fa5\w-]+$/;var EDIT_USERNAME=$(".profile-edit-username").val();edit_username_correct=!1;if(EDIT_USERNAME.length<1){$('#profile_error_username').css('visibility','visible');document.getElementById("profile_error_username").innerHTML="暱稱不能為空喔！"}
else{if(EDIT_USERNAME.length>12){$('#profile_error_username').css('visibility','visible');document.getElementById("profile_error_username").innerHTML="暱稱只能小於12個字！"}
else{if(!EDIT_USERNAME.match(username_format)){$('#profile_error_username').css('visibility','visible');document.getElementById("profile_error_username").innerHTML="不能使用注音及空白喔！ 符號只能使用-或_"}
else{$.ajax({type:'POST',url:'/profile-db.php',data:{edit_username:EDIT_USERNAME,edit_type:"edit_check_username"},success:function(response){if(response==!0){edit_username_correct=!0;$('#profile_error_username').css('visibility','hidden');document.getElementById("profile_error_username").innerHTML="MSG"}
else{$('.uploadimg_url-error').css('visibility','visible');document.getElementById("profile_error_username").innerHTML="暱稱有人用過了喔！"}}})}}}});$(document).on('keyup change','#profile-edit-email',function(){edit_email_correct=!1;var mail_format=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;var EDIT_EMAIL=$(".profile-edit-email").val();if(EDIT_EMAIL.length<1){if($(".fb_hide_pw").length){$('#profile_error_email').css('visibility','hidden');document.getElementById("profile_error_email").innerHTML="MSG";edit_email_correct=!0}
else{$('#profile_error_email').css('visibility','visible');document.getElementById("profile_error_email").innerHTML="信箱不能為空"}}
else{if(!EDIT_EMAIL.match(mail_format)){$('#profile_error_email').css('visibility','visible');document.getElementById("profile_error_email").innerHTML="信箱格式不正確"}
else{$.ajax({type:'POST',url:'/profile-db.php',data:{edit_email:EDIT_EMAIL,edit_type:"edit_check_email"},success:function(response){if(response==!0){edit_email_correct=!0;$('#profile_error_email').css('visibility','hidden');document.getElementById("profile_error_email").innerHTML="MSG"}
else{$('#profile_error_email').css('visibility','visible');document.getElementById("profile_error_email").innerHTML="信箱有人用過了喔！"}}})}}});$(document).on('keyup change','#profile-edit-pw-original',function(){var PW_ORIGINAL=$(".profile-edit-pw-original").val();if(PW_ORIGINAL.length<1){edit_pw_original_correct=!1;$('#profile_error_pw_original').css('visibility','hidden');document.getElementById("profile_error_pw_original").innerHTML="MSG"}
else{if(PW_ORIGINAL.length<8||PW_ORIGINAL.length>20){$('#profile_error_pw_original').css('visibility','visible');document.getElementById("profile_error_pw_original").innerHTML="舊密碼錯誤喔！";edit_pw_original_correct=!1}
else{$.ajax({type:'POST',url:'/profile-db.php',data:{pw_original:PW_ORIGINAL,edit_type:"check_pw_original"},success:function(response){if(response==!0){edit_pw_original_correct=!0;$('#profile_error_pw_original').css('visibility','hidden');document.getElementById("profile_error_email").innerHTML="　"}
else{edit_pw_original_correct=!1;$('#profile_error_pw_original').css('visibility','visible');document.getElementById("profile_error_pw_original").innerHTML="舊密碼錯誤喔！"}}})}}});$(document).on('keyup change','#profile-edit-pw-new',function(){$('#profile_error_pw_newcheck').css('visibility','hidden');document.getElementById("profile_error_pw_newcheck").innerHTML="MSG";var PW_NEW=$(".profile-edit-pw-new").val();var PW_ORIGINAL=$(".profile-edit-pw-original").val();edit_pw_new_correct=!1;$(".profile-edit-pw-newcheck").val('');if(PW_ORIGINAL.length>0){if(PW_NEW.length<1){$('#profile_error_pw_new').css('visibility','hidden');document.getElementById("profile_error_pw_new").innerHTML="MSG";edit_pw_new_correct=!1}
else{if(PW_NEW.length<8||PW_NEW.length>20){$('#profile_error_pw_new').css('visibility','visible');document.getElementById("profile_error_pw_new").innerHTML="密碼長度為8~20個字喔";edit_pw_new_correct=!1}
else{$('#profile_error_pw_new').css('visibility','visible');document.getElementById("profile_error_pw_new").innerHTML="　";edit_pw_new_correct=!0}}}
else{$('#profile_error_pw_new').css('visibility','visible');document.getElementById("profile_error_pw_new").innerHTML="還沒輸入舊密碼喔！"}
if(PW_NEW.length==0){$('#profile_error_pw_new').css('visibility','hidden');document.getElementById("profile_error_pw_new").innerHTML="MSG"}});$(document).on('keyup change','#profile-edit-pw-newcheck',function(){var PW_NEW=$(".profile-edit-pw-new").val();var PW_NEW_CHECK=$(".profile-edit-pw-newcheck").val();var PW_ORIGINAL=$(".profile-edit-pw-original").val();edit_pw_newcheck_correct=!1;if(PW_ORIGINAL.length>0){if(PW_NEW!=PW_NEW_CHECK){$('#profile_error_pw_newcheck').css('visibility','visible');document.getElementById("profile_error_pw_newcheck").innerHTML="密碼不相符喔！";edit_pw_newcheck_correct=!1}
else{$('#profile_error_pw_newcheck').css('visibility','hidden');document.getElementById("profile_error_pw_newcheck").innerHTML="MSG";edit_pw_newcheck_correct=!0}}
else{$('#profile_error_pw_newcheck').css('visibility','visible');document.getElementById("profile_error_pw_newcheck").innerHTML="還沒輸入舊密碼喔！"}
if(PW_NEW_CHECK.length==0){$('#profile_error_pw_newcheck').css('visibility','hidden');document.getElementById("profile_error_pw_newcheck").innerHTML="MSG"}});$(document).on('click','.submit-edit-profile',function(){var PW_ORIGINAL=$(".profile-edit-pw-original").val();var PW_NEW=$(".profile-edit-pw-new").val();var PW_NEW_CHECK=$(".profile-edit-pw-newcheck").val();if(PW_ORIGINAL.length<1&&PW_NEW.length<1&&PW_NEW_CHECK.length<1){edit_pw_original_correct=!0;edit_pw_new_correct=!0;edit_pw_newcheck_correct=!0}
if($(".fb_hide_pw").length){}
if(edit_username_correct==!0&&edit_email_correct==!0&&edit_pw_original_correct==!0&&edit_pw_new_correct==!0&&edit_pw_newcheck_correct==!0){var formdata=new FormData();formdata.append('profile_uploadtype','none');if(edit_member_pic===!0){formdata.append('profile_uploadtype',edit_uploadtype);if(edit_uploadtype==="file"){formdata.append('profile_uploadpic',edit_picfile)}
else if(edit_uploadtype==="url"){formdata.append('profile_uploadpic',edit_picurl)}}
var EDIT_USERNAME=$(".profile-edit-username").val();var EDIT_EMAIL=$(".profile-edit-email").val();formdata.append('edit_username',EDIT_USERNAME);formdata.append('edit_email',EDIT_EMAIL);formdata.append('pw_new',PW_NEW);formdata.append('edit_type',"submit_edit_profile");$(".edit-profile-div *").prop('disabled',!0);$('.submit-profile-msg').text('傳送中...');$.ajax({type:'POST',url:'/profile-db.php',data:formdata,processData:!1,contentType:!1,success:function(response){if(response==!0){location.reload()}
else{$('.submit-profile-msg').text('');alert('修改失敗！請再試一次')}
$(".edit-profile-div *").prop('disabled',!1)}})}});scrollTop:$(window.location.hash).offset().top})
